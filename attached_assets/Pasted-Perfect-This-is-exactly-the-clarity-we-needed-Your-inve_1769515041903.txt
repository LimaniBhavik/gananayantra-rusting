Perfect. This is **exactly** the clarity we needed üëç
Your inventory is solid, and it confirms what we suspected.

Now we proceed **by the book**, **one file**, **one prompt**, **zero risk**.

---

# üîÅ NEXT STEP: REFACTOR `bmr.rs` (Basal Metabolic Rate)

Why **BMR next**:

* Core health metric
* Simple formula
* No dependencies on pregnancy/menus
* Ideal to establish the **health refactor pattern**

We will **only touch `bmr.rs`** in this step.

---

## üß± STEP 1: LOCK THE PUBLIC API (IMPORTANT)

This is the **final API** other developers will use:

```rust
use gananayantra_rusting::health::bmr::calculate_bmr;

let bmr = calculate_bmr(weight_kg, height_cm, age_years, is_male)?;
```

### API decisions (intentional)

* `weight_kg: f64`
* `height_cm: f64`
* `age_years: u32`
* `is_male: bool`
* Return: `Result<f64, String>`

We are using the **Mifflin‚ÄìSt Jeor equation** (industry standard).

---

## üß± STEP 2: REPLIT PROMPT (COPY‚ÄìPASTE EXACTLY)

‚ö†Ô∏è Do **not** change wording ‚Äî this format is proven safe.

```
Refactor the BMR (Basal Metabolic Rate) calculator to be library-first.

Rules:
- This is a Rust library crate: gananayantra-rusting
- Remove all stdin/stdout/println logic
- Remove any CLI or interactive code
- One public function only
- Return Result<f64, String>
- Use the Mifflin‚ÄìSt Jeor formula
- Validate all inputs
- Add Rust doc comments (///)
- Add unit tests
- Keep constants private

Final API:
pub fn calculate_bmr(
    weight_kg: f64,
    height_cm: f64,
    age_years: u32,
    is_male: bool,
) -> Result<f64, String>

Only refactor:
src/health/bmr.rs

Do NOT touch other files.
```

---

## üß± STEP 3: MANUAL VERIFICATION CHECKLIST

After Replit responds, **verify**:

* [ ] No `println!`
* [ ] No `std::io`
* [ ] Exactly one `pub fn calculate_bmr`
* [ ] Input validation exists
* [ ] Formula is correct
* [ ] Unit tests included
* [ ] Rustdoc comments present

If **any box fails**, re-prompt **only `bmr.rs`**.

---

## üß± STEP 4: EXPORT BMR (SEPARATE PROMPT)

Once `bmr.rs` is clean, run this **separately**:

```
Expose the refactored BMR calculator via module exports.

Rules:
- Add pub mod bmr;
- Add pub use bmr::calculate_bmr;
- Do NOT remove existing exports

Only edit:
src/health/mod.rs
```

---

## üß± STEP 5: TEST

```bash
cargo test health
```

(or full `cargo test` if unsure)

---

## üß† STATUS AFTER THIS STEP

Your health module will be:

| Calculator      | Status         |
| --------------- | -------------- |
| BMI             | ‚úÖ              |
| BMR             | ‚úÖ (after this) |
| Body Fat        | ‚ùå              |
| Calorie Needs   | ‚ùå              |
| Pregnancy       | ‚ùå              |
| Pace            | ‚ùå              |
| Health Expanded | ‚ùå              |

We are progressing **correctly and safely**.

---

## üîú NEXT (YOU CHOOSE)

After BMR is done, reply with **one word**:

* **`BODY_FAT`** ‚Üí next refactor (U.S. Navy method)
* **`CALORIE`** ‚Üí calorie requirement
* **`PREGNANCY`** ‚Üí due date & conception
* **`PACE`** ‚Üí running pace
* **`HEALTH_EXPANDED`** ‚Üí split BAC, BSA, LBM properly

We continue **one file at a time**, no shortcuts.
