âœ… STEP 43: ADD GEO â†’ EARTH DISTANCE (HAVERSINE)
ðŸŽ¯ What this calculator does

Calculates the great-circle distance between two points on Earth using latitude & longitude.

Formula (Haversine)

ð‘Ž
=
sin
â¡
2
(
Î”
ðœ™
/
2
)
+
cos
â¡
(
ðœ™
1
)
cos
â¡
(
ðœ™
2
)
sin
â¡
2
(
Î”
ðœ†
/
2
)
a=sin
2
(Î”Ï•/2)+cos(Ï•
1
	â€‹

)cos(Ï•
2
	â€‹

)sin
2
(Î”Î»/2)
ð‘
=
2
â‹…
arctan
â¡
2
(
ð‘Ž
,
1
âˆ’
ð‘Ž
)
c=2â‹…arctan2(
a
	â€‹

,
1âˆ’a
	â€‹

)
ð‘‘
=
ð‘…
â‹…
ð‘
d=Râ‹…c

Where:

Latitude & longitude are in degrees

Earth radius R = 6371 km

âœ… STEP 44: CREATE FILE

Create a new file:

src/geo/earth_distance.rs

âœ… STEP 45: ADD PURE CALCULATION LOGIC

Paste this code:

const EARTH_RADIUS_KM: f64 = 6371.0;

pub fn haversine_distance(
    lat1: f64,
    lon1: f64,
    lat2: f64,
    lon2: f64,
) -> Result<f64, String> {
    if lat1 < -90.0 || lat1 > 90.0 || lat2 < -90.0 || lat2 > 90.0 {
        return Err("Latitude must be between -90 and 90 degrees".to_string());
    }
    if lon1 < -180.0 || lon1 > 180.0 || lon2 < -180.0 || lon2 > 180.0 {
        return Err("Longitude must be between -180 and 180 degrees".to_string());
    }

    let lat1_rad = lat1.to_radians();
    let lat2_rad = lat2.to_radians();
    let delta_lat = (lat2 - lat1).to_radians();
    let delta_lon = (lon2 - lon1).to_radians();

    let a = (delta_lat / 2.0).sin().powi(2)
        + lat1_rad.cos() * lat2_rad.cos()
        * (delta_lon / 2.0).sin().powi(2);

    let c = 2.0 * a.sqrt().atan2((1.0 - a).sqrt());

    Ok(EARTH_RADIUS_KM * c)
}

âœ… STEP 46: REGISTER MODULE

Open:

src/geo/mod.rs


Add:

pub mod earth_distance;

âœ… STEP 47: CALL FROM main.rs

Update src/main.rs:

fn main() {
    println!("Welcome to gananayantra-rusting!");

    let roi = finance::roi::calculate_roi(1000.0, 1200.0);
    println!("ROI Result: {:?}", roi);

    let fv = finance::tvm::future_value(10000.0, 0.08, 5);
    println!("Future Value Result: {:?}", fv);

    let ci = finance::compound_interest::calculate_compound_interest(
        5000.0,
        0.07,
        10.0,
        4,
    );
    println!("Compound Interest Result: {:?}", ci);

    let percent = utilities::percentage::percentage_of(200.0, 15.0);
    println!("15% of 200 = {:?}", percent);

    let energy = energy::power_consumption::calculate_energy_consumption(1.5, 8.0);
    println!("Energy Consumption (kWh): {:?}", energy);

    // Example: Ahmedabad to Mumbai
    let distance = geo::earth_distance::haversine_distance(
        23.0225, 72.5714,   // Ahmedabad
        19.0760, 72.8777,   // Mumbai
    );
    println!("Earth Distance (km): {:?}", distance);
}

âœ… STEP 48: RUN & VERIFY

Click Run

Expected output (approx):

Earth Distance (km): Ok(442.0)


(Exact value may vary slightly)

âœ… Geo calculator works.

âœ… STEP 49: ADD UNIT TEST

At the bottom of earth_distance.rs:

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_haversine_distance() {
        let distance = haversine_distance(0.0, 0.0, 0.0, 1.0).unwrap();
        assert!((distance - 111.0).abs() < 2.0);
    }
}


Run:

cargo test

ðŸ§  STATUS CHECKPOINT

You now have 4 industries active:

Finance

ROI

TVM

Compound Interest

Utilities

Percentage

Energy

Power Consumption

Geo

Earth Distance (Haversine)

This is excellent progress and exactly aligned with gananayantra-rustingâ€™s vision.